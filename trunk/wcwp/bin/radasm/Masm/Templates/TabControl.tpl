Win32 App
TabControl
Tab Control
[*BEGINPRO*]
[*BEGINDEF*]
[MakeDef]
Menu=1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0
1=4,O,$B\RC.EXE /v,1
2=3,O,$B\ML.EXE /c /coff /Cp /nologo /I$I,2
3=5,O,$B\LINK.EXE /SUBSYSTEM:WINDOWS /RELEASE /VERSION:4.0 /LIBPATH:$L,3,4
4=0,0,,5
5=rsrc.obj,O,$B\CVTRES.EXE,rsrc.res
6=*.obj,O,$B\ML.EXE /c /coff /Cp /nologo /I"$I",*.asm
7=0,0,"$E\OllyDbg",5
11=4,O,$B\RC.EXE /v,1
12=3,O,$B\ML.EXE /c /coff /Cp /nologo /I"$I",2
13=5,O,$B\LINK.EXE /SUBSYSTEM:WINDOWS /DEBUG /VERSION:4.0 /LIBPATH:"$L",3,4
14=0,0,,5
15=rsrc.obj,O,$B\CVTRES.EXE,rsrc.res
16=*.obj,O,$B\ML.EXE /c /coff /Cp /nologo /I"$I",*.asm
17=0,0,"$E\OllyDbg",5
[MakeFiles]
0=TabControl.rap
1=TabControl.rc
2=TabControl.asm
3=TabControl.obj
4=TabControl.res
5=TabControl.exe
6=TabControl.def
7=TabControl.dll
8=TabControl.txt
9=TabControl.lib
10=TabControl.mak
11=TabControl.hla
12=TabControl.com
[Resource]
[StringTable]
[VerInf]
[*ENDDEF*]
[*BEGINTXT*]
TabControl.Asm
.386
.model flat,stdcall
option casemap:none

include TabControl.inc

.code

start:

	invoke GetModuleHandle, NULL
	mov		hInstance, eax
	invoke InitCommonControls		
	invoke DialogBoxParam,hInstance,IDD_TABTEST,NULL,addr DlgProc,NULL
	invoke ExitProcess,eax 

Tab1Proc proc hWin:HWND,uMsg:UINT,wParam:WPARAM,lParam:LPARAM

	.if uMsg==WM_INITDIALOG
	.else
		mov		eax,FALSE
		ret
	.endif
	mov		eax,TRUE
	ret

Tab1Proc endp

Tab2Proc proc hWin:HWND,uMsg:UINT,wParam:WPARAM,lParam:LPARAM

	.if uMsg==WM_INITDIALOG
	.else
		mov		eax,FALSE
		ret
	.endif
	mov		eax,TRUE
	ret

Tab2Proc endp

Tab3Proc proc hWin:HWND,uMsg:UINT,wParam:WPARAM,lParam:LPARAM

	.if uMsg==WM_INITDIALOG
	.else
		mov		eax,FALSE
		ret
	.endif
	mov		eax,TRUE
	ret

Tab3Proc endp

DlgProc proc hWin:HWND,uMsg:UINT,wParam:WPARAM,lParam:LPARAM
	LOCAL	ts:TC_ITEM

	mov		eax,uMsg
	.if eax==WM_COMMAND
		mov		eax,wParam
		mov		edx,eax
		and		eax,0FFFFh
		shr		edx,16
		.if edx==BN_CLICKED
			.if eax==IDCANCEL
				invoke SendMessage,hWin,WM_CLOSE,0,0
			.elseif eax==IDOK
				invoke SendMessage,hWin,WM_CLOSE,0,0
			.endif
		.endif
	.elseif eax==WM_NOTIFY
		mov		eax,lParam
		mov		eax,[eax].NMHDR.code
		.if eax==TCN_SELCHANGE
			;Tab selection
			invoke SendMessage,hTab,TCM_GETCURSEL,0,0
			.if eax!=SelTab
				push	eax
				mov		eax,SelTab
				invoke ShowWindow,[hTabDlg+eax*4],SW_HIDE
				pop		eax
				mov		SelTab,eax
				invoke ShowWindow,[hTabDlg+eax*4],SW_SHOWDEFAULT
			.endif
		.endif
	.elseif eax==WM_INITDIALOG
		;Create the tabs
		invoke GetDlgItem,hWin,IDC_TAB1
		mov		hTab,eax
		mov		ts.imask,TCIF_TEXT
		mov		ts.lpReserved1,0
		mov		ts.lpReserved2,0
		mov		ts.iImage,-1
		mov		ts.lParam,0
		mov		ts.pszText,offset TabTitle1
		mov		ts.cchTextMax,sizeof TabTitle1
		invoke SendMessage,hTab,TCM_INSERTITEM,0,addr ts
		mov		ts.pszText,offset TabTitle2
		mov		ts.cchTextMax,sizeof TabTitle2
		invoke SendMessage,hTab,TCM_INSERTITEM,1,addr ts
		mov		ts.pszText,offset TabTitle3
		mov		ts.cchTextMax,sizeof TabTitle3
		invoke SendMessage,hTab,TCM_INSERTITEM,2,addr ts
		;Create the tab dialogs
		invoke CreateDialogParam,hInstance,IDD_TAB1,hTab,addr Tab1Proc,0
		mov hTabDlg,eax
		invoke CreateDialogParam,hInstance,IDD_TAB2,hTab,addr Tab2Proc,0
		mov hTabDlg[4],eax
		invoke CreateDialogParam,hInstance,IDD_TAB3,hTab,addr Tab3Proc,0
		mov hTabDlg[8],eax
	.elseif eax==WM_CLOSE
		invoke EndDialog,hWin,NULL
	.else
		mov		eax,FALSE
		ret
	.endif
	mov		eax,TRUE
	ret

DlgProc endp

end start
[*ENDTXT*]
[*BEGINTXT*]
TabControl.Inc
include windows.inc
include user32.inc
include kernel32.inc
include comctl32.inc


includelib user32.lib
includelib kernel32.lib
includelib comctl32.lib

;Debug macros
;include masm32.inc
;include debug.inc
;includelib masm32.lib
;includelib debug.lib
;
DlgProc			PROTO :DWORD,:DWORD,:DWORD,:DWORD

.const

IDD_TABTEST		equ 1000
IDC_TAB1		equ 1001

IDD_TAB1		equ 2000

IDD_TAB2		equ 3000

IDD_TAB3		equ 4000

.data

TabTitle1       db "Tab1",0
TabTitle2       db "Tab2",0
TabTitle3       db "Tab3",0

.data?

hInstance		dd ?
hTab			dd ?
hTabDlg			dd 3 dup(?)
SelTab			dd ?
[*ENDTXT*]
[*BEGINTXT*]
TabControl.Rc
#include "Res/TabControlDlg.rc"
#include "Res/Tab1Dlg.rc"
#include "Res/Tab2Dlg.rc"
#include "Res/Tab3Dlg.rc"
[*ENDTXT*]
[*BEGINBIN*]
TabControl.dlg
6400000001000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
00000000000000004D532053616E732053657269660000000000000000000000
000000000000000008000000F6FFFFFF00000000E90300000000000000000000
00000000010000000000000000000000EC06000001000000A73441001C070000
000000008008C810010000000A0000000A0000002D010000DF00000054616220
44656D6F00000000000000000000000000000000000000000000000000000000
0000000000000000E80300004944445F54414254455354000000000000000000
0000000000000000000000000000000000000000D40600000000000082254280
EC060000DC0600000080015000000000030000000300000021010000A6000000
0000000000000000000000000000000000000000000000000000000000000000
0B0000000000000000000000E90300004944435F544142310000000000000000
0000000000000000000000000000000000000000000000005C01000000000000
DA254280EC060000000000000100015000000000A2000000AE0000003A000000
130000004F4B005F42544E000000000000000000000000000000000000000000
000000000400000000000000010000000100000049444F4B00544E3100000000
00000000000000000000000000000000000000000000000000000000E0020000
00000000DA254280EC060000000000000000015000000000E7000000AE000000
3A0000001300000043616E63656C000000000000000000000000000000000000
000000000000000004000000000000000200000002000000494443414E43454C
0000000000000000000000000000000000000000000000000000000000000000
[*ENDBIN*]
[*BEGINBIN*]
Tab1.dlg
6400000001000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
00000000000000004D532053616E732053657269660000000000000000000000
000000000000000008000000F6FFFFFF00000000D10700000000000000000000
00000000010000000000000000000000D40300000100000079344100B8030000
00000000000000500000000003000000160000001E0100008E0000000044445F
444C470000000000000000000000000000000000000000000000000000000000
0000000000000000D00700004944445F54414231000000000000000000000000
0000000000000000000000000000000000000000D803000000000000B2C93680
D4030000000000000000015000020000030000001B0000001801000016000000
0000000000000000000000000000000000000000000000000000000000000000
010000000000000000000000D10700004944435F544142314544543100000000
000000000000000000000000000000000000000000000000C403000000000000
C0C83680D403000000000000000100500000000006000000060000009A000000
1000000054616220310043000000000000000000000000000000000000000000
00000000020000000000000001000000D20700004944435F5354435441423100
00000000000000000000000000000000000000000000000000000000
[*ENDBIN*]
[*BEGINBIN*]
Tab2.dlg
6400000001000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
00000000000000004D532053616E732053657269660000000000000000000000
000000000000000008000000F6FFFFFF00000000B90B00000000000000000000
00000000010000000000000000000000C00E00000100000079344100880E0000
00000000000000400000000003000000160000001E0100008E0000000044445F
444C470000000000000000000000000000000000000000000000000000000000
0000000000000000B80B00004944445F54414232000000000000000000000000
0000000000000000000000000000000000000000B80E000000000000B2C93680
C00E0000000000000000015000020000030000001B0000001801000016000000
0000000000000000000000000000000000000000000000000000000000000000
010000000000000000000000B90B00004944435F544142324544543100000000
000000000000000000000000000000000000000000000000AC0E000000000000
C0C83680C00E000000000000000100500000000006000000060000009A000000
1000000054616220320043000000000000000000000000000000000000000000
00000000020000000000000001000000FFFFFFFF0044435F5354435441423200
0000000000000000000000000000000000000000000000000000000078070000
00000000B2C93680C00E00000000000000000150000200000300000036000000
1801000016000000000000000000000000000000000000000000000000000000
0000000000000000010000000000000002000000BA0B00004944435F54414232
4544543200000000000000000000000000000000000000000000000000000000
[*ENDBIN*]
[*BEGINBIN*]
Tab3.dlg
6400000001000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
00000000000000004D532053616E732053657269660000000000000000000000
000000000000000008000000F6FFFFFF00000000A10F00000000000000000000
00000000010000000000000000000000400F000001000000793441004C0F0000
00000000000000400000000003000000160000001E0100008E00000000616100
444C470000000000000000000000000000000000000000000000000000000000
0000000000000000A00F00004944445F54414233000000000000000000000000
0000000000000000000000000000000000000000B00F000000000000C0C83680
400F000000000000000100500000000006000000060000009A00000010000000
5461622033004300000000000000000000000000000000000000000000000000
020000000000000000000000FFFFFFFF0044435F535443310042320000000000
0000000000000000000000000000000000000000000000004009000000000000
B2C93680400F0000000000000000015000020000030000003600000018010000
1600000000000000000000000000000000000000000000000000000000000000
00000000010000000000000002000000A20F00004944435F5441423345445432
00000000000000000000000000000000000000000000000000000000D0040000
00000000B2C93680400F0000000000000000015000020000030000001B000000
1801000016000000000000000000000000000000000000000000000000000000
0000000000000000010000000000000001000000A10F00004944435F54414233
4544543100000000000000000000000000000000000000000000000000000000
7C09000000000000B2C93680400F000000000000000001500002000003000000
5100000018010000160000000000000000000000000000000000000000000000
000000000000000000000000010000000000000003000000A30F00004944435F
5441423345445433000000000000000000000000000000000000000000000000
00000000
[*ENDBIN*]
[*ENDPRO*]
[*BEGINTXT*]
Res\Tab1Dlg.Rc
#define IDD_TAB1 2000
#define IDC_TAB1EDT1 2001
#define IDC_STCTAB1 2002
IDD_TAB1 DIALOGEX 1,13,190,87
FONT 8,"MS Sans Serif"
STYLE 0x50000000
EXSTYLE 0x00000000
BEGIN
  EDITTEXT IDC_TAB1EDT1,1,16,186,13,0x50010000,0x00000200
  LTEXT "Tab 1",IDC_STCTAB1,3,3,102,9,0x50000100,0x00000000
END
[*ENDTXT*]
[*BEGINTXT*]
Res\Tab2Dlg.Rc
#define IDD_TAB2 3000
#define IDC_TAB2EDT1 3001
#define IDC_TAB2EDT2 3002
IDD_TAB2 DIALOGEX 1,13,190,87
FONT 8,"MS Sans Serif"
STYLE 0x40000000
EXSTYLE 0x00000000
BEGIN
  EDITTEXT IDC_TAB2EDT1,1,16,186,13,0x50010000,0x00000200
  LTEXT "Tab 2",-1,3,3,102,9,0x50000100,0x00000000
  EDITTEXT IDC_TAB2EDT2,1,33,186,13,0x50010000,0x00000200
END
[*ENDTXT*]
[*BEGINTXT*]
Res\Tab3Dlg.Rc
#define IDD_TAB3 4000
#define IDC_TAB3EDT2 4002
#define IDC_TAB3EDT1 4001
#define IDC_TAB3EDT3 4003
IDD_TAB3 DIALOGEX 1,13,190,87
FONT 8,"MS Sans Serif"
STYLE 0x40000000
EXSTYLE 0x00000000
BEGIN
  LTEXT "Tab 3",-1,3,3,102,9,0x50000100,0x00000000
  EDITTEXT IDC_TAB3EDT1,1,16,186,13,0x50010000,0x00000200
  EDITTEXT IDC_TAB3EDT2,1,33,186,13,0x50010000,0x00000200
  EDITTEXT IDC_TAB3EDT3,1,49,186,13,0x50010000,0x00000200
END
[*ENDTXT*]
[*BEGINTXT*]
Res\TabControlDlg.Rc
#define IDD_TABTEST 1000
#define IDC_TAB1 1001
#define IDOK 1
#define IDCANCEL 2
IDD_TABTEST DIALOGEX 6,6,196,121
CAPTION "Tab Demo"
FONT 8,"MS Sans Serif"
STYLE 0x10C80880
EXSTYLE 0x00000001
BEGIN
  CONTROL "",IDC_TAB1,"SysTabControl32",0x50018000,1,1,192,102,0x00000000
  PUSHBUTTON "OK",IDOK,107,107,38,11,0x50010001,0x00000000
  PUSHBUTTON "Cancel",IDCANCEL,153,107,38,11,0x50010000,0x00000000
END
[*ENDTXT*]
