#
#Tue Jun 07 01:02:08 CST 2011
RUNTYPE=R
TASK_ID=A05008
MODULE=JF
RUNSQL=select TRADEMARK, DR_TYPE, SERVICE_ID, BILL_MONTH, RATE_PROD_ID,VALID_RATE_PROD_ID, PRODUCT_ID, PROMOTION_PRODS, PLAN_ID, CUST_ID, ACC_ID, USER_ID, CONDITION_ID, IMSI, HPLMN1, HPLMN2, HPLMN3, VPLMN1, VPLMN2, RATING_RES, RATING_FLAG, ITEM_CODE1, CHARGE1, CHARGE1_DISC, ITEM_CODE2, CHARGE2, CHARGE2_DISC, ITEM_CODE3, CHARGE3, CHARGE3_DISC, ITEM_CODE4, CHARGE4, CHARGE4_DISC,free_res_val, substr(free_res_val,instr(free_res_val,',',1,2)+1,instr(free_res_val,',',1,3)-instr(free_res_val,',',1,2)-1), substr(free_res_val,instr(free_res_val,',',1,6)+1,instr(free_res_val,',',1,7)-instr(free_res_val,',',1,6)-1),substr(free_res_val,instr(free_res_val,',',1,10)+1,instr(free_res_val,',',1,11)-instr(free_res_val,',',1,10)-1), substr(free_res_val,instr(free_res_val,',',1,14)+1,instr(free_res_val,',',1,14)-instr(free_res_val,',',1,13)-1), substr(free_res_val,instr(free_res_val,',',1,18)+1,instr(free_res_val,',',1,19)-instr(free_res_val,',',1,18)-1), substr(free_res_val,instr(free_res_val,',',1,22)+1,instr(free_res_val,',',1,22)-instr(free_res_val,',',1,21)-1), TO_CHAR(START_TIME,'YYYYMMDDHH24MISS') START_TIME, TO_CHAR(STOP_TIME,'YYYYMMDDHH24MISS') STOP_TIME, USER_NUMBER, DEV_CODE, APP_TYPE, SRC_TYPE, OPER_CODE, SP_CODE, SEQUENCE_NO, ROAM_TYPE, DISCOUNT, DNLOAD_DURATION, VALID_TIMES, ONLINE_DURATION, DATA_SIZE, PRIORITY, CDR_STATE, CARRY_TYPE, CHARGE_TYPE, SERVICE_KEY, OPP_NUMBER, OPP_TYPE, STD_BASIC_CHARGE,STD_TOLL_CHARGE,STD_OTHER_CHARGE,ORI_BASIC_CHARGE, ORI_TOLL_CHARGE, ORI_OTHER_CHARGE, TO_CHAR(PROCESS_TIME,'YYYYMMDDHH24MISS') PROCESS_TIME, ORIGINAL_FILE, BACKUP_DATE, COLLECTION_ITEM, REDO_FLAG, RESERVE1, RESERVE2, RESERVE3, RESERVE4, LATE_LINK, TO_CHAR(INPUT_TIME,'YYYYMMDDHH24MISS') INPUT_TIME, ROW_ID, USER_PROPERTY,MONITOR_CDR,STD_ERR_CODE from xzjf.dr_kj_$YYYYMMDD$
DATECYCLE=D
CYCLE=20110607
DATEPARAM=$YYYYMMDD$
AREAPARAM=891,892,893,894,895,896,897
