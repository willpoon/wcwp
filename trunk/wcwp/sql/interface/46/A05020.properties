#
#Tue Jun 07 01:06:16 CST 2011
RUNTYPE=R
TASK_ID=A05020
MODULE=JF
RUNSQL=select TRADEMARK ,DR_TYPE ,SERVICE_ID ,BILL_MONTH ,RATE_PROD_ID ,VALID_RATE_PROD_ID,PRODUCT_ID ,PROMOTION_PRODS ,PLAN_ID ,CUST_ID ,ACC_ID ,USER_ID ,CONDITION_ID ,IMSI ,USER_NUMBER ,HPLMN1 ,HPLMN2 ,HPLMN3 ,VPLMN1 ,VPLMN2 ,ROAM_NET_TYPE ,TO_CHAR(START_TIME,'YYYYMMDDHH24MISS') START_TIME ,DURATION ,RATING_RES ,RATING_FLAG ,ITEM_CODE1 ,CHARGE1 ,CHARGE1_DISC ,ITEM_CODE2 ,CHARGE2 ,CHARGE2_DISC ,ITEM_CODE3 ,CHARGE3 ,CHARGE3_DISC ,ITEM_CODE4 ,CHARGE4 ,CHARGE4_DISC ,free_res_val,substr(free_res_val,instr(free_res_val,',',1,2)+1,instr(free_res_val,',',1,3)-instr(free_res_val,',',1,2)-1), substr(free_res_val,instr(free_res_val,',',1,6)+1,instr(free_res_val,',',1,7)-instr(free_res_val,',',1,6)-1),substr(free_res_val,instr(free_res_val,',',1,10)+1,instr(free_res_val,',',1,11)-instr(free_res_val,',',1,10)-1), substr(free_res_val,instr(free_res_val,',',1,14)+1,instr(free_res_val,',',1,14)-instr(free_res_val,',',1,13)-1), substr(free_res_val,instr(free_res_val,',',1,18)+1,instr(free_res_val,',',1,19)-instr(free_res_val,',',1,18)-1), substr(free_res_val,instr(free_res_val,',',1,22)+1,instr(free_res_val,',',1,22)-instr(free_res_val,',',1,21)-1) ,ADDUP_RES_VAL,substr(ADDUP_RES_VAL,instr(ADDUP_RES_VAL,',',1,1)+1,instr(ADDUP_RES_VAL,',',1,2)-instr(ADDUP_RES_VAL,',',1,1)-1)    ADDUP_RES_CODE1, substr(ADDUP_RES_VAL,instr(ADDUP_RES_VAL,',',1,3)+1,instr(ADDUP_RES_VAL,',',1,4)-instr(ADDUP_RES_VAL,',',1,3)-1)    ADDUP_RES_VAL1, substr(ADDUP_RES_VAL,instr(ADDUP_RES_VAL,',',1,7)+1,instr(ADDUP_RES_VAL,',',1,8)-instr(ADDUP_RES_VAL,',',1,7)-1) ADDUP_RES_CODE2, substr(ADDUP_RES_VAL,instr(ADDUP_RES_VAL,',',1,9)+1,instr(ADDUP_RES_VAL,',',1,10)-instr(ADDUP_RES_VAL,',',1,9)-1) ADDUP_RES_VAL2, substr(ADDUP_RES_VAL,instr(ADDUP_RES_VAL,',',1,13)+1,instr(ADDUP_RES_VAL,',',1,14)-instr(ADDUP_RES_VAL,',',1,13)-1) ADDUP_RES_CODE3, substr(ADDUP_RES_VAL,instr(ADDUP_RES_VAL,',',1,15)+1,instr(ADDUP_RES_VAL,',',1,16)-instr(ADDUP_RES_VAL,',',1,15)-1) ADDUP_RES_VAL3, RECORD_TYPE ,CALLER_INDICATE ,SGSN_ADDRESS ,SGSN_CHANGE ,MSNC ,LAC_ID ,CELL_ID ,RAC ,CHARGING_ID ,GGSN_ADDRESS ,APN_NI ,APN_OI ,PDP_TYPE ,PDP_ADDRESS ,CAUSE_CLOSE ,COMBINE_RESULT ,ROAM_TYPE ,UPVOLUME ,DOWNVOLUME ,PARTIAL_NUM ,ADDUP_RES ,TARIFF_SEQ_ID1 ,QOS_REQ_RELIABILITY1 ,QOS_REQ_DELAY1 ,QOS_REQ_PRECEDENCE1 ,QOS_REQ_PEAK1 ,QOS_REQ_MEAN1 ,QOS_NEG_RELIABILITY1 ,QOS_NEG_DELAY1 ,QOS_NEG_PRECEDENCE1 ,QOS_NEG_PEAK1 ,QOS_NEG_MEAN1 ,DATA_FLOW_UP1 ,DATA_FLOW_DOWN1 ,TO_CHAR(BEGIN_TIME1,'YYYYMMDDHH24MISS') BEGIN_TIME1 ,DURATION1 ,TARIFF_SEQ_ID2 ,QOS_REQ_RELIABILITY2 ,QOS_REQ_DELAY2 ,QOS_REQ_PRECEDENCE2 ,QOS_REQ_PEAK2 ,QOS_REQ_MEAN2 ,QOS_NEG_RELIABILITY2 ,QOS_NEG_DELAY2 ,QOS_NEG_PRECEDENCE2 ,QOS_NEG_PEAK2 ,QOS_NEG_MEAN2 ,DATA_FLOW_UP2 ,DATA_FLOW_DOWN2 ,TO_CHAR(BEGIN_TIME2,'YYYYMMDDHH24MISS') BEGIN_TIME2 ,DURATION2 ,TARIFF_SEQ_ID3 ,QOS_REQ_RELIABILITY3 ,QOS_REQ_DELAY3 ,QOS_REQ_PRECEDENCE3 ,QOS_REQ_PEAK3 ,QOS_REQ_MEAN3 ,QOS_NEG_RELIABILITY3 ,QOS_NEG_DELAY3 ,QOS_NEG_PRECEDENCE3 ,QOS_NEG_PEAK3 ,QOS_NEG_MEAN3 ,DATA_FLOW_UP3 ,DATA_FLOW_DOWN3 ,TO_CHAR(BEGIN_TIME3,'YYYYMMDDHH24MISS') BEGIN_TIME3 ,DURATION3 , STD_BASIC_CHARGE,STD_TOLL_CHARGE,STD_OTHER_CHARGE,ORI_BASIC_CHARGE ,ORI_TOLL_CHARGE ,ORI_OTHER_CHARGE ,TO_CHAR(PROCESS_TIME,'YYYYMMDDHH24MISS') PROCESS_TIME ,ORIGINAL_FILE ,BACKUP_DATE ,USER_TYPE ,COLLECTION_ITEM ,REDO_FLAG ,RESERVE1 ,RESERVE2 ,RESERVE3 ,RESERVE4 ,LATE_LINK ,TO_CHAR(INPUT_TIME,'YYYYMMDDHH24MISS')  INPUT_TIME ,ROW_ID,MONITOR_CDR,STD_ERR_CODE from xzjf.DR_GPRS_L_$YYYYMMDD$
CYCLE=20110607
DATECYCLE=D
DATEPARAM=$YYYYMMDD$
AREAPARAM=891,892,893,894,895,896,897
