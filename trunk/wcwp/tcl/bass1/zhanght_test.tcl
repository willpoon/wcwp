#*************************************************
#*规则编号：1~60
#*规则类型：日
#*规则描述：
      #1	MK0401	梦网短信用户数
      #2	MK0402	梦网短信计费量
      #3	MK0403	梦网短信通信费
      #4	MK0404	彩信使用用户数
      #5	MK0405	点对点彩信用户数
      #6	MK0406	梦网彩信用户数
      #7	MK0407	邮箱彩信用户数
      #8	MK0408	彩信计费量
      #9	MK0409	点对点彩信计费量
      #10	MK0410	梦网彩信计费量
      #11	MK0411	邮箱彩信计费量
      #12	MK0412	彩信通信费收入
      #13	MK0413	点对点彩信通信费
      #14	MK0414	梦网彩信通信费
      #15	MK0415	邮箱彩信通信费
      #16	MK0416	彩铃到达数
      #17	MK0417	彩铃信息费
      #18	MK0418	WAP的通信费
      #19	MK0419	WAP的总信息费
      #20	MK0420	短信话单类型取值分布是否符合实际情况
      #21	MK0421	短信计费类型取值分布是否符合实际情况
      #22	MK0422	短信业务类型取值分布是否符合实际情况
      #23	MK0423	"信息费字段填写是否规范：
      #           依据计费类别，分别为
      #           00：填零
      #           01-填零
      #           02-本条短信的费用
      #           03-填零
      #           04-填零
      #           05-本条短信费用或包月费"
      #24	MK0424	"包月费字段填写是否规范：
      #           依据计费类别，分别为：
      #           00-填零
      #           01-填零
      #           02-填零
      #           03-包月金额
      #           04-封顶金额
      #           05-填零"
      #25	MK0425	彩信话单类型取值分布是否符合实际情况
      #26	MK0426	彩信应用类型取值分布是否符合实际情况
      #27	MK0427	彩信计费类型取值分布是否符合实际情况
      #28	MK0428	彩信业务类型取值分布是否符合实际情况
      #29	MK0429	"彩信话单中的SP企业代码对应的
      #           SP企业代码表中SP业务类型编码分类统计各类型的SP企业数。"
      #30	MK0430	"彩信话单中的SP企业代码对应的
      #           SP企业代码表中SP业务类型编码分类统计各类型的信息费总计。"
      #31	MK0431	梦网WAP话单类型取值分布是否符合实际情况
      #32	MK0432	WAP信息计费类型取值分布是否符合实际情况
      #33	MK0433	计费类型取值分布是否符合实际情况
      #34	MK0434	定制途径取值分布是否符合实际情况
      #35	MK0435	"彩铃话单中的SP企业代码对应的
      #           SP企业代码表中SP业务类型编码分类统计各类型的SP企业数。"
      #36	MK0436	"彩铃话单中的SP企业代码对应的
      #           SP企业代码表中SP业务类型编码分类统计各类型的信息费总计。"
      #37	MK0437	"梦网短信话单中的SP企业代码对应的
      #           SP企业代码表中SP业务类型编码分类统计各类型的SP企业数。"
      #38	MK0438	"梦网短信话单中的SP企业代码对应的
      #           SP企业代码表中SP业务类型编码分类统计各类型的信息费总计。"
      #39	MK0439	按次计费，包月费=0
      #40	MK0440	WAP信息计费类别编码=1，本次/包月=0；编码=2，包月=0
      #41	MK0441	状态=1（失败），本次/包月=0
      #42	MK0442	WAP信息计费类别编码为2时的信息费汇总
      #43	MK0443	WAP信息计费类别编码为3时的信息费汇总
      #44	MK0444	"梦网WAP话单中的SP企业代码对应的
      #           SP企业代码表中SP业务类型编码为1的SP企业数。"
      #45	MK0445	"梦网WAP话单中的SP企业代码对应的
      #           SP企业代码表中SP业务类型编码为1的信息费总计。"
      #46	MK2101	"语音杂志业务使用中的SP企业代码对应的
      #           SP企业代码表中SP业务类型编码分类统计各类型的SP企业数。"
      #47	MK2102	"语音杂志业务使用中的SP企业代码对应的
      #           SP企业代码表中SP业务类型编码分类统计各类型的信息费总计。"
      #48	MK2103	"移动沙龙业务使用中的SP企业代码对应的
      #           SP企业代码表中SP业务类型编码分类统计各类型的SP企业数。"
      #49	MK2104	"移动沙龙业务使用中的SP企业代码对应的
      #           SP企业代码表中SP业务类型编码分类统计各类型的信息费总计。"
      #50	MK0501	应收劳务费用合计
      #51	MK0502	应付结算费用合计
      #52	MK0446	彩信话单业务类型是点对点彩信，彩信话单应用类型为非点对点彩信应用类型（即1― Email(MM3接口的外接应用)到终端、2― 终端到Email(MM3接口的外接应用)、3― VAS应用到终端、4― 终端到VAS应用）的话单数
      #53	MK0447	彩信话单业务类型为非点对点彩信，彩信话单应用类型为点对点彩信（终端到终端）的话单数
      #54	MK0448	点对点彩信群发监控-各省每日点对点彩信计费量大于等于1000条的号码个数
      #55	MK0449	点对点彩信群发监控-各省每日点对点彩信计费量大于等于1000条的发送条数
      #56	MK0450	点对点彩信群发监控-各省每日点对点彩信计费量大于等于1000条的群发费用
      #57	MK0451	WAP信息计费类别编码=2(按次计费）时，包月费不等于零的记录数。
      #58	MK0452	"WAP信息计费类别编码=1(免费赠送的WAP信息(保留)）时，包月费或者本条信息费不等于零的记录数。"
      #59	MK0453	WAP状态=1(失败）时，包月费或者本条信息费不等于零的记录数。
      #60	MK0454	wap话单类型=0（按次计费业务话单），包月费不等于零的记录数。

#调用例程：int -s SP_CHECK_REPORT_MONTH
#创建日期：2007-08-01
#创 建 者：xiahuaxue
#修改历史：
#**************************************************/
proc Deal { op_time optime_month province_id redo_number trace_fd bass1_dir temp_data_dir semi_data_dir final_data_dir conn conn_ctl src_data obj_data final_data } {
        
	      #当天 yyyymmdd
        set timestamp [string range $op_time 0 3][string range $op_time 5 6][string range $op_time 8 9]       

        #本月 yyyymm
        set op_month [string range $optime_month 0 3][string range $optime_month 5 6]          
        #本月最后一天 yyyymmdd
        set this_month_last_day [string range $op_month 0 5][GetThisMonthDays [string range $op_month 0 5]01]
        
	      #本年天数 this_year_days	
        set this_year_days [GetThisYearDays ${op_month}01]

	      #本月天数	this_month_days
        set this_month_days [GetThisMonthDays ${op_month}01]


        #上月	$last_month	
       set last_month [GetLastMonth [string range $op_month 0 5]]
       
       #上年最后一个月
       set LastYearMonth [GetLastMonth [string range $op_month 0 3]01]
   

  puts $timestamp
  puts $op_month


  #删除本期数据
	set sql_buff "delete from bass1.G_REPORT_CHECK where TIME_ID= $op_month AND 
	              RULE_ID IN ('B1','B2','B3','B4','B5','B6','B7','B8','B9','B10',
	                          'B11','B12','B13','B14','B15','B16','B17','B18','B19','B20',
	                          'B21','B22','B23','B24','B25','B26','B27','B28','B29','B30',
	                          'B31','B32','B33','B34','B35','B36','B37','B38','B39','B40',
	                          'B41','B42','B43','B44','B45','B46','B47','B48','B49','B50',
	                          'B51','B52','B53','B54','B55','B56','B57','B58','B59','B60');"
  puts $sql_buff
  exec_sql $sql_buff
  #--------------------------------------------------------------------------------------------------------------
  
  #1.主题名称：服务使用 编号：04005 接口名称：梦网短信话单 
  #  规则描述：梦网短信用户数
 	set sql_buff "SELECT COUNT(DISTINCT PRODUCT_NO)  
                  FROM BASS1.G_S_04005_DAY
                 WHERE TIME_ID/100=$op_month"
  set RESULT_VAL [get_single $sql_buff]
  puts "1:梦网短信用户数  $RESULT_VAL"
  
 
   	set sql_buff "INSERT INTO bass1.G_REPORT_CHECK(TIME_ID,RULE_ID,FLAG,RET_VAL) VALUES
		(                                             
			$op_month,
			'B1',
			1,
			'$RESULT_VAL')"
  exec_sql $sql_buff
  #--------------------------------------------------------------------------------------------------------------
  
   
  #2.主题名称：服务使用 编号：04005 接口名称：梦网短信话单 
  #  规则描述：梦网短信计费量
 	set sql_buff "SELECT COUNT(*)  
                  FROM BASS1.G_S_04005_DAY
                 WHERE TIME_ID/100=$op_month AND 
                       BIGINT(SMS_BASEFEE )+BIGINT(INFO_FEE)+BIGINT(MONTH_FEE)>0"
  set RESULT_VAL [get_single $sql_buff]
  puts "2:梦网短信计费量  $RESULT_VAL"
  
 
   	set sql_buff "INSERT INTO bass1.G_REPORT_CHECK(TIME_ID,RULE_ID,FLAG,RET_VAL) VALUES
		(                                             
			$op_month,
			'B2',
			1,
			'$RESULT_VAL')"
  exec_sql $sql_buff
  #--------------------------------------------------------------------------------------------------------------
  


 
  #3.主题名称：服务使用 编号：04005 接口名称：梦网短信话单 
  #  规则描述：梦网短信通信费 
 	set sql_buff "SELECT SUM(BIGINT(SMS_BASEFEE))
                  FROM BASS1.G_S_04005_DAY
                 WHERE TIME_ID/100=$op_month AND 
                       BIGINT(SMS_BASEFEE)+BIGINT(INFO_FEE)+BIGINT(MONTH_FEE)>0"
  set RESULT_VAL [get_single $sql_buff]
  puts "3:梦网短信通信费  $RESULT_VAL"
  
 
   	set sql_buff "INSERT INTO bass1.G_REPORT_CHECK(TIME_ID,RULE_ID,FLAG,RET_VAL) VALUES
		(                                             
			$op_month,
			'B3',
			1,
			'$RESULT_VAL')"
  exec_sql $sql_buff
  #--------------------------------------------------------------------------------------------------------------



  #4.主题名称：服务使用 编号：04004 接口名称：彩信话单 
  #  规则描述：彩信使用用户数 
 	set sql_buff "SELECT COUNT(DISTINCT PRODUCT_NO)
                  FROM BASS1.G_S_04004_DAY
                 WHERE TIME_ID/100=$op_month"
  set RESULT_VAL [get_single $sql_buff]
  puts "4:彩信使用用户数  $RESULT_VAL"
  
 
   	set sql_buff "INSERT INTO bass1.G_REPORT_CHECK(TIME_ID,RULE_ID,FLAG,RET_VAL) VALUES
		(                                             
			$op_month,
			'B4',
			1,
			'$RESULT_VAL')"
  exec_sql $sql_buff
  #--------------------------------------------------------------------------------------------------------------
 


  #5.主题名称：服务使用 编号：04004 接口名称：彩信话单 
  #  规则描述：点对点彩信用户数  
 	set sql_buff "SELECT COUNT(DISTINCT PRODUCT_NO)
                  FROM BASS1.G_S_04004_DAY
                 WHERE TIME_ID/100=$op_month                 AND 
                       (BUS_SRV_ID='1' OR BUS_SRV_ID='4')"
  set RESULT_VAL [get_single $sql_buff]
  puts "5:点对点彩信用户数  $RESULT_VAL"
  
 
   	set sql_buff "INSERT INTO bass1.G_REPORT_CHECK(TIME_ID,RULE_ID,FLAG,RET_VAL) VALUES
		(                                             
			$op_month,
			'B5',
			1,
			'$RESULT_VAL')"
  exec_sql $sql_buff
  #--------------------------------------------------------------------------------------------------------------
 

  
  #6.主题名称：服务使用 编号：04004 接口名称：彩信话单 
  #  规则描述：梦网彩信用户数  
 	set sql_buff "SELECT COUNT(DISTINCT PRODUCT_NO)
                  FROM BASS1.G_S_04004_DAY
                 WHERE TIME_ID/100=$op_month AND 
                       BUS_SRV_ID='2' "
  set RESULT_VAL [get_single $sql_buff]
  puts "6:梦网彩信用户数  $RESULT_VAL"
  
 
   	set sql_buff "INSERT INTO bass1.G_REPORT_CHECK(TIME_ID,RULE_ID,FLAG,RET_VAL) VALUES
		(                                             
			$op_month,
			'B6',
			1,
			'$RESULT_VAL')"
  exec_sql $sql_buff
  #--------------------------------------------------------------------------------------------------------------

  
  #7.主题名称：服务使用 编号：04004 接口名称：彩信话单 
  #  规则描述：邮箱彩信用户数  
 	set sql_buff "SELECT COUNT(DISTINCT PRODUCT_NO)
                  FROM BASS1.G_S_04004_DAY
                 WHERE TIME_ID/100=$op_month AND 
                       BUS_SRV_ID='3' "
  set RESULT_VAL [get_single $sql_buff]
  puts "7:邮箱彩信用户数  $RESULT_VAL"
  
 
   	set sql_buff "INSERT INTO bass1.G_REPORT_CHECK(TIME_ID,RULE_ID,FLAG,RET_VAL) VALUES
		(                                             
			$op_month,
			'B7',
			1,
			'$RESULT_VAL')"
  exec_sql $sql_buff
  #--------------------------------------------------------------------------------------------------------------

  
  #8.主题名称：服务使用 编号：04004 接口名称：彩信话单 
  #  规则描述：彩信计费量  
 	set sql_buff "SELECT COUNT(DISTINCT PRODUCT_NO)
                  FROM BASS1.G_S_04004_DAY
                 WHERE TIME_ID/100=$op_month                  AND 
                       BIGINT(CALL_FEE)+BIGINT(INFO_FEE)>0 "
  set RESULT_VAL [get_single $sql_buff]
  puts "8:彩信计费量  $RESULT_VAL"
  
 
   	set sql_buff "INSERT INTO bass1.G_REPORT_CHECK(TIME_ID,RULE_ID,FLAG,RET_VAL) VALUES
		(                                             
			$op_month,
			'B8',
			1,
			'$RESULT_VAL')"
  exec_sql $sql_buff
  #--------------------------------------------------------------------------------------------------------------

 
  
  #9.主题名称：服务使用 编号：04004 接口名称：彩信话单 
  #  规则描述：点对点彩信计费量    
 	set sql_buff "SELECT COUNT(DISTINCT PRODUCT_NO)
                  FROM BASS1.G_S_04004_DAY
                 WHERE TIME_ID/100=$op_month                  AND 
                       BIGINT(CALL_FEE)+BIGINT(INFO_FEE)>0    AND 
                       (BUS_SRV_ID='1' OR BUS_SRV_ID='4')"
  set RESULT_VAL [get_single $sql_buff]
  puts "9:点对点彩信计费量  $RESULT_VAL"
  
 
   	set sql_buff "INSERT INTO bass1.G_REPORT_CHECK(TIME_ID,RULE_ID,FLAG,RET_VAL) VALUES
		(                                             
			$op_month,
			'B9',
			1,
			'$RESULT_VAL')"
  exec_sql $sql_buff
  #--------------------------------------------------------------------------------------------------------------

 
  #10.主题名称：服务使用 编号：04004 接口名称：彩信话单 
  #  规则描述：梦网彩信计费量    
 	set sql_buff "SELECT COUNT(DISTINCT PRODUCT_NO)
                  FROM BASS1.G_S_04004_DAY
                 WHERE TIME_ID/100=$op_month                  AND 
                       BIGINT(CALL_FEE)+BIGINT(INFO_FEE)>0    AND 
                       BUS_SRV_ID='2'"
  set RESULT_VAL [get_single $sql_buff]
  puts "10:梦网彩信计费量  $RESULT_VAL"
  
 
   	set sql_buff "INSERT INTO bass1.G_REPORT_CHECK(TIME_ID,RULE_ID,FLAG,RET_VAL) VALUES
		(                                             
			$op_month,
			'B10',
			1,
			'$RESULT_VAL')"
  exec_sql $sql_buff
  #--------------------------------------------------------------------------------------------------------------
 
  #11.主题名称：服务使用 编号：04004 接口名称：彩信话单 
  #   规则描述：邮箱彩信计费量    
 	set sql_buff "SELECT COUNT(DISTINCT PRODUCT_NO)
                  FROM BASS1.G_S_04004_DAY
                 WHERE TIME_ID/100=$op_month                   AND 
                       BIGINT(CALL_FEE)+BIGINT(INFO_FEE)>0  AND 
                       BUS_SRV_ID='3'"
  set RESULT_VAL [get_single $sql_buff]
  puts "11:邮箱彩信计费量  $RESULT_VAL"
  
 
   	set sql_buff "INSERT INTO bass1.G_REPORT_CHECK(TIME_ID,RULE_ID,FLAG,RET_VAL) VALUES
		(                                             
			$op_month,
			'B11',
			1,
			'$RESULT_VAL')"
  exec_sql $sql_buff
  #--------------------------------------------------------------------------------------------------------------
 

  #12.主题名称：服务使用 编号：04004 接口名称：彩信话单 
  #   规则描述：彩信通信费收入   
 	set sql_buff "SELECT SUM(BIGINT(CALL_FEE))
                  FROM BASS1.G_S_04004_DAY
                 WHERE TIME_ID/100=$op_month"
  set RESULT_VAL [get_single $sql_buff]
  puts "12:彩信通信费收入  $RESULT_VAL"
  
 
   	set sql_buff "INSERT INTO bass1.G_REPORT_CHECK(TIME_ID,RULE_ID,FLAG,RET_VAL) VALUES
		(                                             
			$op_month,
			'B12',
			1,
			'$RESULT_VAL')"
  exec_sql $sql_buff
  #--------------------------------------------------------------------------------------------------------------
  
 

  #13.主题名称：服务使用 编号：04004 接口名称：彩信话单 
  #   规则描述：点对点彩信通信费   
 	set sql_buff "SELECT SUM(BIGINT(CALL_FEE))
                  FROM BASS1.G_S_04004_DAY
                 WHERE TIME_ID/100=$op_month                  AND 
                       (BUS_SRV_ID='1' OR BUS_SRV_ID='4')"
  set RESULT_VAL [get_single $sql_buff]
  puts "13:点对点彩信通信费  $RESULT_VAL"
  
 
   	set sql_buff "INSERT INTO bass1.G_REPORT_CHECK(TIME_ID,RULE_ID,FLAG,RET_VAL) VALUES
		(                                             
			$op_month,
			'B13',
			1,
			'$RESULT_VAL')"
  exec_sql $sql_buff
  #--------------------------------------------------------------------------------------------------------------
  
 
  #14.主题名称：服务使用 编号：04004 接口名称：彩信话单 
  #   规则描述：梦网彩信通信费   
 	set sql_buff "SELECT SUM(BIGINT(CALL_FEE))
                  FROM BASS1.G_S_04004_DAY
                 WHERE TIME_ID/100=$op_month AND 
                       BUS_SRV_ID='2'"
  set RESULT_VAL [get_single $sql_buff]
  puts "14:梦网彩信通信费  $RESULT_VAL"
  
 
   	set sql_buff "INSERT INTO bass1.G_REPORT_CHECK(TIME_ID,RULE_ID,FLAG,RET_VAL) VALUES
		(                                             
			$op_month,
			'B14',
			1,
			'$RESULT_VAL')"
  exec_sql $sql_buff
  #--------------------------------------------------------------------------------------------------------------
  
 

  #15.主题名称：服务使用 编号：04004 接口名称：彩信话单 
  #   规则描述：邮箱彩信通信费   
 	set sql_buff "SELECT SUM(BIGINT(CALL_FEE))
                  FROM BASS1.G_S_04004_DAY
                 WHERE TIME_ID/100=$op_month  AND 
                       BUS_SRV_ID='3'"
  set RESULT_VAL [get_single $sql_buff]
  puts "15:邮箱彩信通信费  $RESULT_VAL"
  
 
   	set sql_buff "INSERT INTO bass1.G_REPORT_CHECK(TIME_ID,RULE_ID,FLAG,RET_VAL) VALUES
		(                                             
			$op_month,
			'B15',
			1,
			'$RESULT_VAL')"
  exec_sql $sql_buff
  #--------------------------------------------------------------------------------------------------------------
  
  
 
  #16.主题名称：服务使用 编号：04004 接口名称：彩铃话单 
  #   规则描述：彩铃到达数   
 	set sql_buff "SELECT value(count(distinct PRODUCT_NO),0)
                  FROM BASS1.G_S_04015_DAY
                 WHERE TIME_ID/100=$op_month"
  set RESULT_VAL [get_single $sql_buff]
  puts "16:彩铃到达数  $RESULT_VAL"
  
 
   	set sql_buff "INSERT INTO bass1.G_REPORT_CHECK(TIME_ID,RULE_ID,FLAG,RET_VAL) VALUES
		(                                             
			$op_month,
			'B16',
			1,
			'$RESULT_VAL')"
  exec_sql $sql_buff
  #--------------------------------------------------------------------------------------------------------------
 

  #17.主题名称：服务使用 编号：04004 接口名称：彩铃话单 
  #   规则描述：彩铃信息费    
 	set sql_buff "SELECT value(sum(bigint(fee_amt)),0)
                  FROM BASS1.G_S_04015_DAY
                 WHERE TIME_ID/100=$op_month"
  set RESULT_VAL [get_single $sql_buff]
  puts "17:彩铃信息费  $RESULT_VAL"
  
 
   	set sql_buff "INSERT INTO bass1.G_REPORT_CHECK(TIME_ID,RULE_ID,FLAG,RET_VAL) VALUES
		(                                             
			$op_month,
			'B17',
			1,
			'$RESULT_VAL')"
  exec_sql $sql_buff
  #--------------------------------------------------------------------------------------------------------------
 
 
 
  #18.主题名称：服务使用 编号：04006 接口名称：梦网WAP话单 
  #   规则描述：WAP的通信费   
 	set sql_buff "SELECT sum(bigint(WAP_BASEFEE))
                  FROM BASS1.G_S_04006_DAY
                 WHERE TIME_ID/100=$op_month"
  set RESULT_VAL [get_single $sql_buff]
  puts "18:WAP的通信费  $RESULT_VAL"
  
 
   	set sql_buff "INSERT INTO bass1.G_REPORT_CHECK(TIME_ID,RULE_ID,FLAG,RET_VAL) VALUES
		(                                             
			$op_month,
			'B18',
			1,
			'$RESULT_VAL')"
  exec_sql $sql_buff
  #--------------------------------------------------------------------------------------------------------------
  
 

 
  #19.主题名称：服务使用 编号：04006 接口名称：梦网WAP话单 
  #   规则描述：WAP的总信息费   
 	set sql_buff "SELECT sum(bigint(INFO_FEE))
                  FROM BASS1.G_S_04006_DAY
                 WHERE TIME_ID/100=$op_month"
  set RESULT_VAL [get_single $sql_buff]
  puts "19:WAP的总信息费  $RESULT_VAL"
  
 
   	set sql_buff "INSERT INTO bass1.G_REPORT_CHECK(TIME_ID,RULE_ID,FLAG,RET_VAL) VALUES
		(                                             
			$op_month,
			'B19',
			1,
			'$RESULT_VAL')"
  exec_sql $sql_buff
  #--------------------------------------------------------------------------------------------------------------
  
 

   #20.主题名称：服务使用 编号：04005 接口名称：梦网短信话单 
   #   规则描述：短信话单类型取值分布是否符合实际情况  
  
 
  puts "20:短信话单类型取值分布是否符合实际情况  0"
   	set sql_buff "INSERT INTO bass1.G_REPORT_CHECK(TIME_ID,RULE_ID,FLAG,RET_VAL) VALUES
		(                                             
			$op_month,
			'B20',
			1,
			'0')"
  exec_sql $sql_buff
  #--------------------------------------------------------------------------------------------------------------
  
  
   #21.主题名称：服务使用 编号：04005 接口名称：梦网短信话单 
   #   规则描述：短信计费类型取值分布是否符合实际情况 
  
 
  puts "21:短信计费类型取值分布是否符合实际情况  0"
   	set sql_buff "INSERT INTO bass1.G_REPORT_CHECK(TIME_ID,RULE_ID,FLAG,RET_VAL) VALUES
		(                                             
			$op_month,
			'B21',
			1,
			'0')"
  exec_sql $sql_buff
  #--------------------------------------------------------------------------------------------------------------
 

 
   #22.主题名称：服务使用 编号：04005 接口名称：梦网短信话单 
   #   规则描述：短信业务类型取值分布是否符合实际情况
  
 
  puts "22:短信业务类型取值分布是否符合实际情况  0"
   	set sql_buff "INSERT INTO bass1.G_REPORT_CHECK(TIME_ID,RULE_ID,FLAG,RET_VAL) VALUES
		(                                             
			$op_month,
			'B22',
			1,
			'0')"
  exec_sql $sql_buff
  #--------------------------------------------------------------------------------------------------------------

  
 
   #23.主题名称：服务使用 编号：04005 接口名称：梦网短信话单 
   #   规则描述：信息费字段填写是否规范：依据计费类别，分别为 00：填零 01-填零 02-本条短信的费用 03-填零 04-填零 05-本条短信费用或包月费 
  
 
  puts "23:信息费字段填写是否规范  0"
   	set sql_buff "INSERT INTO bass1.G_REPORT_CHECK(TIME_ID,RULE_ID,FLAG,RET_VAL) VALUES
		(                                             
			$op_month,
			'B23',
			1,
			'0')"
  exec_sql $sql_buff
  #--------------------------------------------------------------------------------------------------------------
  
 

   #24.主题名称：服务使用 编号：04005 接口名称：梦网短信话单 
   #   规则描述：包月费字段填写是否规范：依据计费类别，分别为： 00-填零 01-填零 02-填零 03-包月金额 04-封顶金额 05-填零
  
 
  puts "24:包月费字段填写是否规范  0"
   	set sql_buff "INSERT INTO bass1.G_REPORT_CHECK(TIME_ID,RULE_ID,FLAG,RET_VAL) VALUES
		(                                             
			$op_month,
			'B24',
			1,
			'0')"
  exec_sql $sql_buff
  #--------------------------------------------------------------------------------------------------------------

  
 
   #25.主题名称：服务使用 编号：04004 接口名称：彩信话单 
   #   规则描述：彩信话单类型取值分布是否符合实际情况 
  
 
  puts "25:彩信话单类型取值分布是否符合实际情况  0"
   	set sql_buff "INSERT INTO bass1.G_REPORT_CHECK(TIME_ID,RULE_ID,FLAG,RET_VAL) VALUES
		(                                             
			$op_month,
			'B25',
			1,
			'0')"
  exec_sql $sql_buff
  #--------------------------------------------------------------------------------------------------------------
  
 
   #26.主题名称：服务使用 编号：04004 接口名称：彩信话单 
   #   规则描述：彩信应用类型取值分布是否符合实际情况 
  
 
  puts "26:彩信应用类型取值分布是否符合实际情况  0"
   	set sql_buff "INSERT INTO bass1.G_REPORT_CHECK(TIME_ID,RULE_ID,FLAG,RET_VAL) VALUES
		(                                             
			$op_month,
			'B26',
			1,
			'0')"
  exec_sql $sql_buff
  #--------------------------------------------------------------------------------------------------------------
  

  
 
   #27.主题名称：服务使用 编号：04004 接口名称：彩信话单 
   #   规则描述：彩信计费类型取值分布是否符合实际情况   
  
 
  puts "27:彩信计费类型取值分布是否符合实际情况  0"
   	set sql_buff "INSERT INTO bass1.G_REPORT_CHECK(TIME_ID,RULE_ID,FLAG,RET_VAL) VALUES
		(                                             
			$op_month,
			'B27',
			1,
			'0')"
  exec_sql $sql_buff
  #--------------------------------------------------------------------------------------------------------------

  
 
   #28.主题名称：服务使用 编号：04004 接口名称：彩信话单 
   #   规则描述：彩信业务类型取值分布是否符合实际情况
  
 
  puts "28:彩信业务类型取值分布是否符合实际情况  0"
   	set sql_buff "INSERT INTO bass1.G_REPORT_CHECK(TIME_ID,RULE_ID,FLAG,RET_VAL) VALUES
		(                                             
			$op_month,
			'B28',
			1,
			'0')"
  exec_sql $sql_buff
  #--------------------------------------------------------------------------------------------------------------
  
 

   #29.主题名称：服务使用 编号：04004/06012 接口名称：彩信话单/SP企业代码 
   #   规则描述：彩信话单中的SP企业代码对应的 SP企业代码表中SP业务类型编码分类统计各类型的SP企业数。
  
 
  puts "29:彩信话单中的SP企业代码对应的SP企业代码表中SP业务类型编码分类统计各类型的SP企业数  0"
   	set sql_buff "INSERT INTO bass1.G_REPORT_CHECK(TIME_ID,RULE_ID,FLAG,RET_VAL) VALUES
		(                                             
			$op_month,
			'B29',
			1,
			'0')"
  exec_sql $sql_buff
  #--------------------------------------------------------------------------------------------------------------
  
  
   #30.主题名称：服务使用 编号：04004/06012 接口名称：彩信话单/SP企业代码 
   #   规则描述：彩信话单中的SP企业代码对应的 SP企业代码表中SP业务类型编码分类统计各类型的信息费总计。
  
 
  puts "30:彩信话单中的SP企业代码对应的SP企业代码表中SP业务类型编码分类统计各类型的信息费总计  0"
   	set sql_buff "INSERT INTO bass1.G_REPORT_CHECK(TIME_ID,RULE_ID,FLAG,RET_VAL) VALUES
		(                                             
			$op_month,
			'B30',
			1,
			'0')"
  exec_sql $sql_buff
  #--------------------------------------------------------------------------------------------------------------
  
 
 
   #31.主题名称：服务使用 编号：04006 接口名称：梦网WAP话单 
   #   规则描述：梦网WAP话单类型取值分布是否符合实际情况  
  
 
  puts "31:梦网WAP话单类型取值分布是否符合实际情况  0"
   	set sql_buff "INSERT INTO bass1.G_REPORT_CHECK(TIME_ID,RULE_ID,FLAG,RET_VAL) VALUES
		(                                             
			$op_month,
			'B31',
			1,
			'0')"
  exec_sql $sql_buff
  #--------------------------------------------------------------------------------------------------------------
  
 

  
 
   #32.主题名称：服务使用 编号：04006 接口名称：梦网WAP话单 
   #   规则描述：WAP信息计费类型取值分布是否符合实际情况
  
 
  puts "32:WAP信息计费类型取值分布是否符合实际情况  0"
   	set sql_buff "INSERT INTO bass1.G_REPORT_CHECK(TIME_ID,RULE_ID,FLAG,RET_VAL) VALUES
		(                                             
			$op_month,
			'B32',
			1,
			'0')"
  exec_sql $sql_buff
  #--------------------------------------------------------------------------------------------------------------
  
  
 

   #33.主题名称：服务使用 编号：04015 接口名称：彩铃话单 
   #   规则描述：计费类型取值分布是否符合实际情况
  
 
  puts "33:计费类型取值分布是否符合实际情况  0"
   	set sql_buff "INSERT INTO bass1.G_REPORT_CHECK(TIME_ID,RULE_ID,FLAG,RET_VAL) VALUES
		(                                             
			$op_month,
			'B33',
			1,
			'0')"
  exec_sql $sql_buff
  #--------------------------------------------------------------------------------------------------------------
  
 

   #34.主题名称：服务使用 编号：04015 接口名称：彩铃话单 
   #   规则描述：定制途径取值分布是否符合实际情况
  
 
  puts "34:定制途径取值分布是否符合实际情况  0"
   	set sql_buff "INSERT INTO bass1.G_REPORT_CHECK(TIME_ID,RULE_ID,FLAG,RET_VAL) VALUES
		(                                             
			$op_month,
			'B34',
			1,
			'0')"
  exec_sql $sql_buff
  #--------------------------------------------------------------------------------------------------------------
  
  
 

   #35.主题名称：服务使用 编号：04015/06012 接口名称：彩铃话单/SP企业代码 
   #   规则描述：彩铃话单中的SP企业代码对应的 SP企业代码表中SP业务类型编码分类统计各类型的SP企业数。
  
 
  puts "35:彩铃话单中的SP企业代码对应的SP企业代码表中SP业务类型编码分类统计各类型的SP企业数  0"
   	set sql_buff "INSERT INTO bass1.G_REPORT_CHECK(TIME_ID,RULE_ID,FLAG,RET_VAL) VALUES
		(                                             
			$op_month,
			'B35',
			1,
			'0')"
  exec_sql $sql_buff
  #--------------------------------------------------------------------------------------------------------------
  
 
   #36.主题名称：服务使用 编号：04015/06012 接口名称：彩铃话单/SP企业代码 
   #   规则描述：彩铃话单中的SP企业代码对应的 SP企业代码表中SP业务类型编码分类统计各类型的信息费总计。
  
 
  puts "36:彩铃话单中的SP企业代码对应的SP企业代码表中SP业务类型编码分类统计各类型的信息费总计  0"
   	set sql_buff "INSERT INTO bass1.G_REPORT_CHECK(TIME_ID,RULE_ID,FLAG,RET_VAL) VALUES
		(                                             
			$op_month,
			'B36',
			1,
			'0')"
  exec_sql $sql_buff
  #--------------------------------------------------------------------------------------------------------------
  

  
 
   #37.主题名称：服务使用 编号：04005/06012 接口名称：梦网短信话单/SP企业代码 
   #   规则描述：梦网短信话单中的SP企业代码对应的 SP企业代码表中SP业务类型编码分类统计各类型的SP企业数。  
  
 
  puts "37:梦网短信话单中的SP企业代码对应的SP企业代码表中SP业务类型编码分类统计各类型的SP企业数  0"
   	set sql_buff "INSERT INTO bass1.G_REPORT_CHECK(TIME_ID,RULE_ID,FLAG,RET_VAL) VALUES
		(                                             
			$op_month,
			'B37',
			1,
			'0')"
  exec_sql $sql_buff
  #--------------------------------------------------------------------------------------------------------------
  

  
 
   #38.主题名称：服务使用 编号：04005/06012 接口名称：梦网短信话单/SP企业代码 
   #   规则描述：梦网短信话单中的SP企业代码对应的 SP企业代码表中SP业务类型编码分类统计各类型的信息费总计。  
  
 
  puts "38:梦网短信话单中的SP企业代码对应的SP企业代码表中SP业务类型编码分类统计各类型的信息费总计  0"
   	set sql_buff "INSERT INTO bass1.G_REPORT_CHECK(TIME_ID,RULE_ID,FLAG,RET_VAL) VALUES
		(                                             
			$op_month,
			'B38',
			1,
			'0')"
  exec_sql $sql_buff
  #--------------------------------------------------------------------------------------------------------------
  

  
 
   #39.主题名称：服务使用 编号：04006 接口名称：梦网WAP话单 
   #   规则描述：按次计费，包月费=0   
 	set sql_buff "SELECT value(count(*),0)
                  FROM BASS1.G_S_04006_DAY
                 WHERE TIME_ID/100=$op_month  AND 
                       ticke_type='00'     AND
                       bigint( MONTH_FEE)>0"
  set RESULT_VAL [get_single $sql_buff]
  puts "39:按次计费，包月费=0  $RESULT_VAL"
    
 
   	set sql_buff "INSERT INTO bass1.G_REPORT_CHECK(TIME_ID,RULE_ID,FLAG,RET_VAL) VALUES
		(                                             
			$op_month,
			'B39',
			1,
			'$RESULT_VAL')"
  exec_sql $sql_buff
  #--------------------------------------------------------------------------------------------------------------
  
  
 

   #40.主题名称：服务使用 编号：04006 接口名称：梦网WAP话单 
   #   规则描述：WAP信息计费类别编码=1，本次/包月=0；编码=2，包月=0     
 	set sql_buff "SELECT value(count(*),0)
                  FROM BASS1.G_S_04006_DAY
                 WHERE TIME_ID/100=$op_month  AND 
                       ((billing_cat_of_wap_info='01' and bigint(WAP_BASEFEE)+bigint(BILLING_CAT_OF_WAP_INFO)+bigint( MONTH_FEE)<>0)
                       or (billing_cat_of_wap_info='02' and bigint( MONTH_FEE)<>0) )"
  set RESULT_VAL [get_single $sql_buff]
  puts "40:WAP信息计费类别编码=1，本次/包月=0；编码=2，包月=0  $RESULT_VAL"
    
 
   	set sql_buff "INSERT INTO bass1.G_REPORT_CHECK(TIME_ID,RULE_ID,FLAG,RET_VAL) VALUES
		(                                             
			$op_month,
			'B40',
			1,
			'$RESULT_VAL')"
  exec_sql $sql_buff
  #--------------------------------------------------------------------------------------------------------------
  
 

   #41.主题名称：服务使用 编号：04006 接口名称：梦网WAP话单 
   #   规则描述：状态=1（失败），本次/包月=0     
 	set sql_buff "SELECT VALUE(COUNT(*),0)
                  FROM BASS1.G_S_04006_DAY
                 WHERE TIME_ID/100=$op_month  AND 
                       CDR_STATUS='01'     AND 
                       BIGINT(WAP_BASEFEE)+BIGINT(BILLING_CAT_OF_WAP_INFO)+BIGINT( MONTH_FEE)<>0"
  set RESULT_VAL [get_single $sql_buff]
  puts "41:状态=1（失败），本次/包月=0  $RESULT_VAL"
    
 
   	set sql_buff "INSERT INTO bass1.G_REPORT_CHECK(TIME_ID,RULE_ID,FLAG,RET_VAL) VALUES
		(                                             
			$op_month,
			'B41',
			1,
			'$RESULT_VAL')"
  exec_sql $sql_buff
  #--------------------------------------------------------------------------------------------------------------
  
 

   #42.主题名称：服务使用 编号：04006 接口名称：梦网WAP话单 
   #   规则描述：WAP信息计费类别编码为2时的信息费汇总    
 	set sql_buff "SELECT sum(bigint(BILLING_CAT_OF_WAP_INFO))
                  FROM BASS1.G_S_04006_DAY
                 WHERE TIME_ID/100=$op_month AND 
                       billing_cat_of_wap_info='02'"
  set RESULT_VAL [get_single $sql_buff]
  puts "42:WAP信息计费类别编码为2时的信息费汇总  $RESULT_VAL"
    
 
   	set sql_buff "INSERT INTO bass1.G_REPORT_CHECK(TIME_ID,RULE_ID,FLAG,RET_VAL) VALUES
		(                                             
			$op_month,
			'B42',
			1,
			'$RESULT_VAL')"
  exec_sql $sql_buff
  #--------------------------------------------------------------------------------------------------------------
  
 

   #43.主题名称：服务使用 编号：04006 接口名称：梦网WAP话单 
   #   规则描述：WAP信息计费类别编码为3时的信息费汇总        
 
  puts "43:WAP信息计费类别编码为3时的信息费汇总 0"
   	set sql_buff "INSERT INTO bass1.G_REPORT_CHECK(TIME_ID,RULE_ID,FLAG,RET_VAL) VALUES
		(                                             
			$op_month,
			'B43',
			1,
			'0')"
   exec_sql $sql_buff
  #--------------------------------------------------------------------------------------------------------------
 

   #44.主题名称：服务使用 编号：04006 接口名称：梦网WAP话单 
   #   规则描述：梦网WAP话单中的SP企业代码对应的 SP企业代码表中SP业务类型编码为1的SP企业数。      
 
  puts "44:梦网WAP话单中的SP企业代码对应的SP企业代码表中SP业务类型编码为1的SP企业数 0"
   	set sql_buff "INSERT INTO bass1.G_REPORT_CHECK(TIME_ID,RULE_ID,FLAG,RET_VAL) VALUES
		(                                             
			$op_month,
			'B44',
			1,
			'0')"
  exec_sql $sql_buff
  #--------------------------------------------------------------------------------------------------------------
 
 

   #45.主题名称：服务使用 编号：04006 接口名称：梦网WAP话单 
   #   规则描述：梦网WAP话单中的SP企业代码对应的 SP企业代码表中SP业务类型编码为1的信息费总计。      
 
  puts "45:梦网WAP话单中的SP企业代码对应的SP企业代码表中SP业务类型编码为1的SP企业数 0"
   	set sql_buff "INSERT INTO bass1.G_REPORT_CHECK(TIME_ID,RULE_ID,FLAG,RET_VAL) VALUES
		(                                             
			$op_month,
			'B45',
			1,
			'0')"
  exec_sql $sql_buff
  #--------------------------------------------------------------------------------------------------------------
  
 

   #46.主题名称：详单汇总数据 编号：21012 接口名称：语音杂志业务使用 
   #   规则描述：语音杂志业务使用中的SP企业代码对应的 SP企业代码表中SP业务类型编码分类统计各类型的SP企业数。      
 
  puts "46:语音杂志业务使用中的SP企业代码对应的SP企业代码表中SP业务类型编码分类统计各类型的SP企业数 0"
   	set sql_buff "INSERT INTO bass1.G_REPORT_CHECK(TIME_ID,RULE_ID,FLAG,RET_VAL) VALUES
		(                                             
			$op_month,
			'B46',
			1,
			'0')"
  exec_sql $sql_buff
  #--------------------------------------------------------------------------------------------------------------
  
 

   #47.主题名称：详单汇总数据 编号：21012 接口名称：语音杂志业务使用 
   #   规则描述：语音杂志业务使用中的SP企业代码对应的 SP企业代码表中SP业务类型编码分类统计各类型的信息费总计。       
 
  puts "47:语音杂志业务使用中的SP企业代码对应的SP企业代码表中SP业务类型编码分类统计各类型的信息费总计 0"
   	set sql_buff "INSERT INTO bass1.G_REPORT_CHECK(TIME_ID,RULE_ID,FLAG,RET_VAL) VALUES
		(                                             
			$op_month,
			'B47',
			1,
			'0')"
  exec_sql $sql_buff
  #--------------------------------------------------------------------------------------------------------------
  
  
 

   #48.主题名称：详单汇总数据 编号：21011 接口名称：移动沙龙业务使用 
   #   规则描述：移动沙龙业务使用中的SP企业代码对应的 SP企业代码表中SP业务类型编码分类统计各类型的SP企业数。         
 
  puts "48:移动沙龙业务使用中的SP企业代码对应的 SP企业代码表中SP业务类型编码分类统计各类型的SP企业数 0"
   	set sql_buff "INSERT INTO bass1.G_REPORT_CHECK(TIME_ID,RULE_ID,FLAG,RET_VAL) VALUES
		(                                             
			$op_month,
			'B48',
			1,
			'0')"
  exec_sql $sql_buff
  #--------------------------------------------------------------------------------------------------------------

  
 

   #49.主题名称：详单汇总数据 编号：21011 接口名称：移动沙龙业务使用 
   #   规则描述：移动沙龙业务使用中的SP企业代码对应的 SP企业代码表中SP业务类型编码分类统计各类型的信息费总计。           
 
  puts "48:移动沙龙业务使用中的SP企业代码对应的SP企业代码表中SP业务类型编码分类统计各类型的信息费总计 0"
   	set sql_buff "INSERT INTO bass1.G_REPORT_CHECK(TIME_ID,RULE_ID,FLAG,RET_VAL) VALUES
		(                                             
			$op_month,
			'B49',
			1,
			'0')"
  exec_sql $sql_buff
  #--------------------------------------------------------------------------------------------------------------

  
 
   #50.主题名称：结算数据 编号：05003 接口名称：SP结算 
   #   规则描述：应收劳务费用合计             
 	set sql_buff "SELECT sum(bigint(pay_fee))
                  FROM BASS1.G_S_05003_month
                 WHERE TIME_ID=$op_month"
  set RESULT_VAL [get_single $sql_buff]
  puts "50:应收劳务费用合计  $RESULT_VAL"
 

   	set sql_buff "INSERT INTO bass1.G_REPORT_CHECK(TIME_ID,RULE_ID,FLAG,RET_VAL) VALUES
		(                                             
			$op_month,
			'B50',
			1,
			'$RESULT_VAL')"
  exec_sql $sql_buff
  #--------------------------------------------------------------------------------------------------------------

  
 

   #51.主题名称：结算数据 编号：05003 接口名称：SP结算 
   #   规则描述：应付结算费用合计              
 	set sql_buff "SELECT sum(bigint(stlmnt_fee))
                  FROM BASS1.G_S_05003_month
                 WHERE TIME_ID=$op_month"
  set RESULT_VAL [get_single $sql_buff]
  puts "51:应付结算费用合计  $RESULT_VAL"
 

   	set sql_buff "INSERT INTO bass1.G_REPORT_CHECK(TIME_ID,RULE_ID,FLAG,RET_VAL) VALUES
		(                                             
			$op_month,
			'B51',
			1,
			'$RESULT_VAL')"
  exec_sql $sql_buff
  #--------------------------------------------------------------------------------------------------------------

 

   #52.主题名称：服务使用 编号：04004 接口名称：彩信话单 
   #   规则描述：彩信话单业务类型是点对点彩信，彩信话单应用类型为非点对点彩信应用类型（即1― Email(MM3接口的外接应用)到终端、2― 终端到Email(MM3接口的外接应用)、3― VAS应用到终端、4― 终端到VAS应用）的话单数                
 	set sql_buff "SELECT count(*)
                  FROM BASS1.G_S_04004_DAY
                 WHERE TIME_ID/100=$op_month      AND 
                       BUS_SRV_ID IN ('1','4') AND 
                       APPLCN_TYPE IN ('1','2','3','4')"
  set RESULT_VAL [get_single $sql_buff]
  puts "52:彩信话单业务类型是点对点彩信  $RESULT_VAL"
 

   	set sql_buff "INSERT INTO bass1.G_REPORT_CHECK(TIME_ID,RULE_ID,FLAG,RET_VAL) VALUES
		(                                             
			$op_month,
			'B52',
			1,
			'$RESULT_VAL')"
  exec_sql $sql_buff
  #--------------------------------------------------------------------------------------------------------------

  
 

   #53.主题名称：服务使用 编号：04004 接口名称：彩信话单 
   #   规则描述：彩信话单业务类型为非点对点彩信，彩信话单应用类型为点对点彩信（终端到终端）的话单数
 	set sql_buff "SELECT count(*)
                  FROM BASS1.G_S_04004_DAY
                 WHERE TIME_ID/100=$op_month      AND 
                       BUS_SRV_ID IN ('2','3')    AND 
                       APPLCN_TYPE='0'"
  set RESULT_VAL [get_single $sql_buff]
  puts "53:彩信话单业务类型为非点对点彩信  $RESULT_VAL"
 

   	set sql_buff "INSERT INTO bass1.G_REPORT_CHECK(TIME_ID,RULE_ID,FLAG,RET_VAL) VALUES
		(                                             
			$op_month,
			'B53',
			1,
			'$RESULT_VAL')"
  exec_sql $sql_buff
  #--------------------------------------------------------------------------------------------------------------
  
 

   #54.主题名称：服务使用 编号：04004 接口名称：彩信话单 
   #   规则描述：点对点彩信群发监控-各省每日点对点彩信计费量大于等于1000条的号码个数
 	set sql_buff "SELECT value(count(*),0)
   from 
        (
    	   SELECT 
    	     PRODUCT_NO,count(*)
    	   FROM BASS1.G_S_04004_DAY
    	   WHERE TIME_ID/100=$op_month
    	   GROUP BY PRODUCT_NO
    	   HAVING COUNT(*)/INT($this_month_days)>=1000
    	 )t"
  set RESULT_VAL [get_single $sql_buff]
  puts "54:点对点彩信群发监控  $RESULT_VAL"
 

   	set sql_buff "INSERT INTO bass1.G_REPORT_CHECK(TIME_ID,RULE_ID,FLAG,RET_VAL) VALUES
		(                                             
			$op_month,
			'B54',
			1,
			'$RESULT_VAL')"
  exec_sql $sql_buff
  #--------------------------------------------------------------------------------------------------------------
  
 

   #55.主题名称：服务使用 编号：04004 接口名称：彩信话单 
   #   规则描述：点对点彩信群发监控-各省每日点对点彩信计费量大于等于1000条的发送条数

  puts "55:点对点彩信群发监控-各省每日点对点彩信计费量大于等于1000条的发送条数  0"
   	set sql_buff "INSERT INTO bass1.G_REPORT_CHECK(TIME_ID,RULE_ID,FLAG,RET_VAL) VALUES
		(                                             
			$op_month,
			'B55',
			1,
			'0')"
  exec_sql $sql_buff
  #--------------------------------------------------------------------------------------------------------------
  
 

   #56.主题名称：服务使用 编号：04004 接口名称：彩信话单 
   #   规则描述：点对点彩信群发监控-各省每日点对点彩信计费量大于等于1000条的群发费用

  puts "56:点对点彩信群发监控-各省每日点对点彩信计费量大于等于1000条的群发费用  0"
   	set sql_buff "INSERT INTO bass1.G_REPORT_CHECK(TIME_ID,RULE_ID,FLAG,RET_VAL) VALUES
		(                                             
			$op_month,
			'B56',
			1,
			'0')"
  exec_sql $sql_buff
  #--------------------------------------------------------------------------------------------------------------
 

  
 
   #57.主题名称：服务使用 编号：04006 接口名称：梦网WAP话单 
   #   规则描述：WAP信息计费类别编码=2(按次计费）时，包月费不等于零的记录数。
 	set sql_buff "SELECT value(count(*),0)
                  FROM BASS1.G_S_04006_DAY
                 WHERE TIME_ID/100=$op_month           and 
                       billing_cat_of_wap_info='02' and 
                       bigint(MONTH_FEE)<>0"
  set RESULT_VAL [get_single $sql_buff]
  puts "57:WAP信息计费类别编码=2(按次计费）时，包月费不等于零的记录数  $RESULT_VAL"
 

   	set sql_buff "INSERT INTO bass1.G_REPORT_CHECK(TIME_ID,RULE_ID,FLAG,RET_VAL) VALUES
		(                                             
			$op_month,
			'B57',
			1,
			'$RESULT_VAL')"
  exec_sql $sql_buff
  #--------------------------------------------------------------------------------------------------------------
  
  
 

   #58.主题名称：服务使用 编号：04006 接口名称：梦网WAP话单 
   #   规则描述：WAP信息计费类别编码=1(免费赠送的WAP信息(保留)）时，包月费或者本条信息费不等于零的记录数。
 	set sql_buff "SELECT value(count(*),0)
                       FROM BASS1.G_S_04006_DAY
                      WHERE TIME_ID/100=$op_month           and 
                            billing_cat_of_wap_info='01' and 
                            bigint(WAP_BASEFEE )+bigint(BILLING_CAT_OF_WAP_INFO )<>0"
  set RESULT_VAL [get_single $sql_buff]
  puts "58:WAP信息计费类别编码=1(免费赠送的WAP信息(保留)）时，包月费或者本条信息费不等于零的记录数  $RESULT_VAL"
 

   	set sql_buff "INSERT INTO bass1.G_REPORT_CHECK(TIME_ID,RULE_ID,FLAG,RET_VAL) VALUES
		(                                             
			$op_month,
			'B58',
			1,
			'$RESULT_VAL')"
  exec_sql $sql_buff
  #--------------------------------------------------------------------------------------------------------------
  
 

   #59.主题名称：服务使用 编号：04006 接口名称：梦网WAP话单 
   #   规则描述：WAP状态=1(失败）时，包月费或者本条信息费不等于零的记录数。
 	set sql_buff "SELECT value(count(*),0)
                  FROM BASS1.G_S_04006_DAY
                 WHERE TIME_ID/100=$op_month and 
                       cdr_status='01'    and 
                       bigint(MONTH_FEE)+bigint(BILLING_CAT_OF_WAP_INFO)<>0"
  set RESULT_VAL [get_single $sql_buff]
  puts "59:WAP状态=1(失败）时，包月费或者本条信息费不等于零的记录数  $RESULT_VAL"
 

   	set sql_buff "INSERT INTO bass1.G_REPORT_CHECK(TIME_ID,RULE_ID,FLAG,RET_VAL) VALUES
		(                                             
			$op_month,
			'B59',
			1,
			'$RESULT_VAL')"
  exec_sql $sql_buff
  #--------------------------------------------------------------------------------------------------------------
  
 

   #60.主题名称：服务使用 编号：04006 接口名称：梦网WAP话单 
   #   规则描述：wap话单类型=0（按次计费业务话单），包月费不等于零的记录数。
 	set sql_buff "SELECT value(count(*),0)
                  FROM BASS1.G_S_04006_DAY
                 WHERE TIME_ID/100=$op_month and 
                       ticke_type='00'    and 
                       bigint(MONTH_FEE)<>0"
  set RESULT_VAL [get_single $sql_buff]
  puts "60:wap话单类型=0（按次计费业务话单），包月费不等于零的记录数  $RESULT_VAL"
 

   	set sql_buff "INSERT INTO bass1.G_REPORT_CHECK(TIME_ID,RULE_ID,FLAG,RET_VAL) VALUES
		(                                             
			$op_month,
			'B60',
			1,
			'$RESULT_VAL')"
  exec_sql $sql_buff
  #--------------------------------------------------------------------------------------------------------------

}		    		
	
	
	
	
	
#内部函数部分	
proc exec_sql {MySQL} {

	global env

	global conn

	global handle

	set handle [aidb_open $conn]
	set sql_buff $MySQL
	if [catch { aidb_sql $handle $sql_buff } errmsg ] {
		WriteTrace "$errmsg" 2005
		aidb_close $handle
		puts $errmsg
		exit -1
	}
	aidb_commit $conn
	aidb_close $handle
	return 0
}
#--------------------------------------------------------------------------------------------------------------

proc get_single {MySQL} {

	global env

	global conn

	global handle

	set handle [aidb_open $conn]
	set sql_buff $MySQL
  if [catch { aidb_sql $handle $sql_buff } errmsg ] {
		WriteTrace $errmsg 1001
		puts $errmsg
		exit -1
	}
	if [catch {set result [lindex [aidb_fetch $handle] 0]} errmsg ] {
		WriteTrace $errmsg 1002
		puts $errmsg
		exit -1
	}
	aidb_commit $conn
	aidb_close $handle
	
	
	return $result
}
#--------------------------------------------------------------------------------------------------------------

