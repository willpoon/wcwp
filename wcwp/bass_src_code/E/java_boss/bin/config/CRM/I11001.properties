#
#Wed May 09 01:10:28 CST 2012
RUNSQL=select PRODUCT_INSTANCE_ID,OFFER_INSTANCE_ID,BRAND_ID,PRODUCT_SPEC_ID,CUST_PARTY_ROLE_ID,PAY_TYPE,BILL_PERIOD,BILL_ID,SUB_BILL_ID,SUB_ID,BILL_START_DATE,FIRST_USE_DATE,ACCT_ID,ACC_NUM,OS_STATUS_PRE,OS_STATUS,VALID_TYPE,OPER_STATE,STATE,VIP_ID,ALARM_LIMIT,AREA_CODE,REAL_PAYMENT,ACCOUNT_FLAG,OWE_MONTHS,OWE_AMOUNT,PASSWORD_TYPE,'' password,FEE_TYPE,USER_TYPE_ID,DISTRICT_ID,CYCLE_FEE_TYPE,NOTICE_FLAG,SLA_MODULE_ID,IS_OUT_NET,ADDRESS_ID,ADDRESS_DESC,AREA_ID,BAL_ORG_ID,BILLING_CYCLE_TYPE_ID,BILL_DTL_SEND_FLAG,BILL_DTL_SEND_CONT,BILL_DTL_SEND_ADDID,DONE_CODE,CREATE_DATE,DONE_DATE,VALID_DATE,EXPIRE_DATE,OP_ID,ORG_ID,WARRANT_CUST_ID,EXT1,EXT2,EXT3,EXT4,EXT5,EXT6,NOTES,REGION_ID,CONT_ID,STATE_DATE,OFFER_ID,CREATE_OP_ID,RISK_FLAG from ( select PRODUCT_INSTANCE_ID,OFFER_INSTANCE_ID,BRAND_ID,PRODUCT_SPEC_ID,CUST_PARTY_ROLE_ID,PAY_TYPE,BILL_PERIOD,BILL_ID,SUB_BILL_ID,SUB_ID,to_char(BILL_START_DATE,'YYYYMMDDHH24MISS') BILL_START_DATE,to_char(FIRST_USE_DATE,'YYYYMMDDHH24MISS') FIRST_USE_DATE,ACCT_ID,ACC_NUM,OS_STATUS_PRE,OS_STATUS,1 valid_type,OPER_STATE,STATE,VIP_ID,ALARM_LIMIT,AREA_CODE,REAL_PAYMENT,ACCOUNT_FLAG,OWE_MONTHS,OWE_AMOUNT,PASSWORD_TYPE,'' password,FEE_TYPE,USER_TYPE_ID,DISTRICT_ID,CYCLE_FEE_TYPE,NOTICE_FLAG,SLA_MODULE_ID,IS_OUT_NET,ADDRESS_ID,ADDRESS_DESC,AREA_ID,BAL_ORG_ID,BILLING_CYCLE_TYPE_ID,BILL_DTL_SEND_FLAG,BILL_DTL_SEND_CONT,BILL_DTL_SEND_ADDID,DONE_CODE,to_char(CREATE_DATE,'YYYYMMDDHH24MISS') CREATE_DATE,to_char(DONE_DATE,'YYYYMMDDHH24MISS') DONE_DATE,to_char(VALID_DATE,'YYYYMMDDHH24MISS') VALID_DATE,to_char(EXPIRE_DATE,'YYYYMMDDHH24MISS') EXPIRE_DATE,OP_ID,ORG_ID,WARRANT_CUST_ID,EXT1,EXT2,EXT3,EXT4,EXT5,EXT6,NOTES,REGION_ID,CONT_ID,to_char(STATE_DATE,'YYYYMMDDHH24MISS') STATE_DATE,OFFER_ID,CREATE_OP_ID,RISK_FLAG ,row_number() over(partition by PRODUCT_INSTANCE_ID order by valid_date desc) row_id from SO.INS_PROD_0$FEE_AREA$ where valid_date<\=to_date('$YYYYMMDD$235959','YYYYMMDDHH24MISS') ) t where t.row_id\=1 union all select PRODUCT_INSTANCE_ID,OFFER_INSTANCE_ID,BRAND_ID,PRODUCT_SPEC_ID,CUST_PARTY_ROLE_ID,PAY_TYPE,BILL_PERIOD,BILL_ID,SUB_BILL_ID,SUB_ID,to_char(BILL_START_DATE,'YYYYMMDDHH24MISS') BILL_START_DATE,to_char(FIRST_USE_DATE,'YYYYMMDDHH24MISS') FIRST_USE_DATE,ACCT_ID,ACC_NUM,OS_STATUS_PRE,OS_STATUS,2 valid_type,OPER_STATE,STATE,VIP_ID,ALARM_LIMIT,AREA_CODE,REAL_PAYMENT,ACCOUNT_FLAG,OWE_MONTHS,OWE_AMOUNT,PASSWORD_TYPE,'' password,FEE_TYPE,USER_TYPE_ID,DISTRICT_ID,CYCLE_FEE_TYPE,NOTICE_FLAG,SLA_MODULE_ID,IS_OUT_NET,ADDRESS_ID,ADDRESS_DESC,AREA_ID,BAL_ORG_ID,BILLING_CYCLE_TYPE_ID,BILL_DTL_SEND_FLAG,BILL_DTL_SEND_CONT,BILL_DTL_SEND_ADDID,DONE_CODE,to_char(CREATE_DATE,'YYYYMMDDHH24MISS') CREATE_DATE,to_char(DONE_DATE,'YYYYMMDDHH24MISS') DONE_DATE,to_char(VALID_DATE,'YYYYMMDDHH24MISS') VALID_DATE,to_char(EXPIRE_DATE,'YYYYMMDDHH24MISS') EXPIRE_DATE,OP_ID,ORG_ID,WARRANT_CUST_ID,EXT1,EXT2,EXT3,EXT4,EXT5,EXT6,NOTES,REGION_ID,CONT_ID,to_char(STATE_DATE,'YYYYMMDDHH24MISS') STATE_DATE,OFFER_ID,CREATE_OP_ID,RISK_FLAG from SO.INS_PROD_0$FEE_AREA$ where valid_date>to_date('$YYYYMMDD$235959','YYYYMMDDHH24MISS') union all select PRODUCT_INSTANCE_ID,OFFER_INSTANCE_ID,BRAND_ID,PRODUCT_SPEC_ID,CUST_PARTY_ROLE_ID,PAY_TYPE,BILL_PERIOD,BILL_ID,SUB_BILL_ID,SUB_ID,BILL_START_DATE,FIRST_USE_DATE,ACCT_ID,ACC_NUM,OS_STATUS_PRE,OS_STATUS,VALID_TYPE,OPER_STATE,STATE,VIP_ID,ALARM_LIMIT,AREA_CODE,REAL_PAYMENT,ACCOUNT_FLAG,OWE_MONTHS,OWE_AMOUNT,PASSWORD_TYPE,'' password,FEE_TYPE,USER_TYPE_ID,DISTRICT_ID,CYCLE_FEE_TYPE,NOTICE_FLAG,SLA_MODULE_ID,IS_OUT_NET,ADDRESS_ID,ADDRESS_DESC,AREA_ID,BAL_ORG_ID,BILLING_CYCLE_TYPE_ID,BILL_DTL_SEND_FLAG,BILL_DTL_SEND_CONT,BILL_DTL_SEND_ADDID,DONE_CODE,CREATE_DATE,DONE_DATE,VALID_DATE,EXPIRE_DATE,OP_ID,ORG_ID,WARRANT_CUST_ID,EXT1,EXT2,EXT3,EXT4,EXT5,EXT6,NOTES,REGION_ID,CONT_ID,STATE_DATE,OFFER_ID,CREATE_OP_ID,RISK_FLAG from (select PRODUCT_INSTANCE_ID,OFFER_INSTANCE_ID,BRAND_ID,PRODUCT_SPEC_ID,CUST_PARTY_ROLE_ID,PAY_TYPE,BILL_PERIOD,BILL_ID,SUB_BILL_ID,SUB_ID,to_char(BILL_START_DATE,'YYYYMMDDHH24MISS') BILL_START_DATE,to_char(FIRST_USE_DATE,'YYYYMMDDHH24MISS') FIRST_USE_DATE,ACCT_ID,ACC_NUM,OS_STATUS_PRE,OS_STATUS,1 valid_type,OPER_STATE,STATE,VIP_ID,ALARM_LIMIT,AREA_CODE,REAL_PAYMENT,ACCOUNT_FLAG,OWE_MONTHS,OWE_AMOUNT,PASSWORD_TYPE,'' password,FEE_TYPE,USER_TYPE_ID,DISTRICT_ID,CYCLE_FEE_TYPE,NOTICE_FLAG,SLA_MODULE_ID,IS_OUT_NET,ADDRESS_ID,ADDRESS_DESC,AREA_ID,BAL_ORG_ID,BILLING_CYCLE_TYPE_ID,BILL_DTL_SEND_FLAG,BILL_DTL_SEND_CONT,BILL_DTL_SEND_ADDID,DONE_CODE,to_char(CREATE_DATE,'YYYYMMDDHH24MISS') CREATE_DATE,to_char(DONE_DATE,'YYYYMMDDHH24MISS') DONE_DATE,to_char(VALID_DATE,'YYYYMMDDHH24MISS') VALID_DATE,to_char(EXPIRE_DATE,'YYYYMMDDHH24MISS') EXPIRE_DATE,OP_ID,ORG_ID,WARRANT_CUST_ID,EXT1,EXT2,EXT3,EXT4,EXT5,EXT6,NOTES,REGION_ID,CONT_ID,to_char(STATE_DATE,'YYYYMMDDHH24MISS') STATE_DATE,OFFER_ID,CREATE_OP_ID,RISK_FLAG,row_number() over(partition by PRODUCT_INSTANCE_ID order by valid_date desc) row_id from SO.INS_PROD_MOVE_0$FEE_AREA$ a where not exists (select 1 from SO.INS_PROD_0$FEE_AREA$ c where a.PRODUCT_INSTANCE_ID \= c.PRODUCT_INSTANCE_ID) ) t where t.row_id \= 1 
CYCLE=20120509
MODULE=CRM
DATEPARAM=$YYYYMMDD$
RUNTYPE=C
DATECYCLE=D
CNT897=202070
CNT896=518507
AREAPARAM=891,892,893,894,895,896,897
CNT895=571704
CNT894=455604
CNT893=407782
CNT892=663517
CNT891=2593313
TASK_ID=I11001
