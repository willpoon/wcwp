#
#Tue Jun 07 01:06:29 CST 2011
TASK_ID=A05009
RUNTYPE=R
MODULE=JF
CYCLE=20110607
DATECYCLE=D
RUNSQL=select TRADEMARK, SERVICE_ID, DR_TYPE, BILL_MONTH, RATE_PROD_ID,VALID_RATE_PROD_ID, PRODUCT_ID, PROMOTION_PRODS, PLAN_ID, OPP_RATE_PROD_ID, CUST_ID, ACC_ID, USER_ID, IMSI, USER_NUMBER, BILL_INDICATE, OPP_NUMBER, OPP_USER_NUMBER, A_NUMBER, TO_CHAR(START_TIME,'YYYYMMDDHH24MISS') START_TIME, DURATION, RATING_RES, CALL_TYPE, ROAM_TYPE, OPP_ACCESS_TYPE, OPP_NUMBER_TYPE, SP_RELA_TYPE, HPLMN1, HPLMN2, HPLMN3, VPLMN1, VPLMN2, RATING_FLAG, ITEM_CODE1, CHARGE1, CHARGE1_DISC, ITEM_CODE2, CHARGE2, CHARGE2_DISC, ITEM_CODE3, CHARGE3, CHARGE3_DISC, ITEM_CODE4, CHARGE4, CHARGE4_DISC,free_res_val, substr(free_res_val,instr(free_res_val,',',1,2)+1,instr(free_res_val,',',1,3)-instr(free_res_val,',',1,2)-1)    FREE_RES_CODE1, substr(free_res_val,instr(free_res_val,',',1,6)+1,instr(free_res_val,',',1,7)-instr(free_res_val,',',1,6)-1)    FREE_RES_VAL1, substr(free_res_val,instr(free_res_val,',',1,10)+1,instr(free_res_val,',',1,11)-instr(free_res_val,',',1,10)-1) FREE_RES_CODE2, substr(free_res_val,instr(free_res_val,',',1,14)+1,instr(free_res_val,',',1,14)-instr(free_res_val,',',1,13)-1) FREE_RES_VAL2, substr(free_res_val,instr(free_res_val,',',1,18)+1,instr(free_res_val,',',1,19)-instr(free_res_val,',',1,18)-1) FREE_RES_CODE3, substr(free_res_val,instr(free_res_val,',',1,22)+1,instr(free_res_val,',',1,22)-instr(free_res_val,',',1,21)-1) FREE_RES_VAL3, STD_UNIT, TOLL_STD_UNIT, STD_BASIC_CHARGE,STD_TOLL_CHARGE,STD_OTHER_CHARGE,ORI_BASIC_CHARGE, ORI_TOLL_CHARGE, ORI_OTHER_CHARGE, ADDUP_RES, OPP_CONDITION_ID, CONDITION_ID, NETCALL_FLAG, ESN, SEQUENCE_NO, MODIFICATION_IND, OPP_ROAM_AREACODE, OPP_HOME_AREACODE, TOLL_TYPE, TOLL_TYPE2, MSRN, MSC_ID, SCP_ID, LAC_ID, CELL_ID, SERVICE_TYPE, SERVICE_CODE, SERVICE_KEY, STOP_CAUSE, IN_TRUNKID, OUT_TRUNKID, GROUP_ID, MOC_ID, MTC_ID, TO_CHAR(PROCESS_TIME,'YYYYMMDDHH24MISS') PROCESS_TIME, BACKUP_DATE, ORIGINAL_FILE, USER_TYPE, VPLMN3, OPP_PLAN_ID, COLLECTION_ITEM, OPP_NOACCESS_NUMBER, REDO_FLAG, RESERVE1, RESERVE2, RESERVE3, RESERVE4, LATE_LINK, TO_CHAR(INPUT_TIME,'YYYYMMDDHH24MISS') INPUT_TIME, ROW_ID,MONITOR_CDR,STD_ERR_CODE,MNS_TYPE from xzjf.DR_GSM_PP_NI_$YYYYMMDD$ union all select TRADEMARK, SERVICE_ID, DR_TYPE, BILL_MONTH, RATE_PROD_ID, VALID_RATE_PROD_ID,PRODUCT_ID, PROMOTION_PRODS, PLAN_ID, OPP_RATE_PROD_ID, CUST_ID, ACC_ID, USER_ID, IMSI, USER_NUMBER, BILL_INDICATE, OPP_NUMBER, OPP_USER_NUMBER, A_NUMBER, to_char(START_TIME,'YYYYMMDDHH24MISS') START_TIME, DURATION, RATING_RES, CALL_TYPE, ROAM_TYPE, OPP_ACCESS_TYPE, OPP_NUMBER_TYPE, SP_RELA_TYPE, HPLMN1, HPLMN2, HPLMN3, VPLMN1, VPLMN2, RATING_FLAG, ITEM_CODE1, CHARGE1, CHARGE1_DISC, ITEM_CODE2, CHARGE2, CHARGE2_DISC, ITEM_CODE3, CHARGE3, CHARGE3_DISC, ITEM_CODE4, CHARGE4, CHARGE4_DISC,free_res_val, substr(free_res_val,instr(free_res_val,',',1,2)+1,instr(free_res_val,',',1,3)-instr(free_res_val,',',1,2)-1)    FREE_RES_CODE1, substr(free_res_val,instr(free_res_val,',',1,6)+1,instr(free_res_val,',',1,6)-instr(free_res_val,',',1,5)-1)    FREE_RES_VAL1, substr(free_res_val,instr(free_res_val,',',1,10)+1,instr(free_res_val,',',1,11)-instr(free_res_val,',',1,10)-1) FREE_RES_CODE2, substr(free_res_val,instr(free_res_val,',',1,14)+1,instr(free_res_val,',',1,14)-instr(free_res_val,',',1,13)-1) FREE_RES_VAL2, substr(free_res_val,instr(free_res_val,',',1,18)+1,instr(free_res_val,',',1,19)-instr(free_res_val,',',1,18)-1) FREE_RES_CODE3, substr(free_res_val,instr(free_res_val,',',1,22)+1,instr(free_res_val,',',1,22)-instr(free_res_val,',',1,21)-1) FREE_RES_VAL3, STD_UNIT, TOLL_STD_UNIT, STD_BASIC_CHARGE,STD_TOLL_CHARGE,STD_OTHER_CHARGE,ORI_BASIC_CHARGE, ORI_TOLL_CHARGE, ORI_OTHER_CHARGE, ADDUP_RES, OPP_CONDITION_ID, CONDITION_ID, NETCALL_FLAG, ESN, SEQUENCE_NO, MODIFICATION_IND, OPP_ROAM_AREACODE, OPP_HOME_AREACODE, TOLL_TYPE, TOLL_TYPE2, MSRN, MSC_ID, SCP_ID, LAC_ID, CELL_ID, SERVICE_TYPE, SERVICE_CODE, SERVICE_KEY, STOP_CAUSE, IN_TRUNKID, OUT_TRUNKID, GROUP_ID, MOC_ID, MTC_ID, to_char(PROCESS_TIME,'YYYYMMDDHH24MISS') PROCESS_TIME, BACKUP_DATE, ORIGINAL_FILE, USER_TYPE, VPLMN3, OPP_PLAN_ID, COLLECTION_ITEM, OPP_NOACCESS_NUMBER, REDO_FLAG, RESERVE1, RESERVE2, RESERVE3, RESERVE4, LATE_LINK, to_char(INPUT_TIME,'YYYYMMDDHH24MISS') INPUT_TIME, ROW_ID,MONITOR_CDR,STD_ERR_CODE,MNS_TYPE from xzjf.dr_gsm_ni_$YYYYMMDD$ union all select TRADEMARK, SERVICE_ID, DR_TYPE, BILL_MONTH, RATE_PROD_ID,VALID_RATE_PROD_ID, PRODUCT_ID, PROMOTION_PRODS, PLAN_ID, OPP_RATE_PROD_ID, CUST_ID, ACC_ID, USER_ID, IMSI, USER_NUMBER, BILL_INDICATE, OPP_NUMBER, OPP_USER_NUMBER, A_NUMBER, to_char(START_TIME,'YYYYMMDDHH24MISS') START_TIME, DURATION, RATING_RES, CALL_TYPE, ROAM_TYPE, OPP_ACCESS_TYPE, OPP_NUMBER_TYPE, SP_RELA_TYPE, HPLMN1, HPLMN2, HPLMN3, VPLMN1, VPLMN2, RATING_FLAG, ITEM_CODE1, CHARGE1, CHARGE1_DISC, ITEM_CODE2, CHARGE2, CHARGE2_DISC, ITEM_CODE3, CHARGE3, CHARGE3_DISC, ITEM_CODE4, CHARGE4, CHARGE4_DISC, free_res_val,substr(free_res_val,instr(free_res_val,',',1,2)+1,instr(free_res_val,',',1,3)-instr(free_res_val,',',1,2)-1)    FREE_RES_CODE1, substr(free_res_val,instr(free_res_val,',',1,6)+1,instr(free_res_val,',',1,6)-instr(free_res_val,',',1,5)-1)    FREE_RES_VAL1, substr(free_res_val,instr(free_res_val,',',1,10)+1,instr(free_res_val,',',1,11)-instr(free_res_val,',',1,10)-1) FREE_RES_CODE2, substr(free_res_val,instr(free_res_val,',',1,14)+1,instr(free_res_val,',',1,14)-instr(free_res_val,',',1,13)-1) FREE_RES_VAL2, substr(free_res_val,instr(free_res_val,',',1,18)+1,instr(free_res_val,',',1,19)-instr(free_res_val,',',1,18)-1) FREE_RES_CODE3, substr(free_res_val,instr(free_res_val,',',1,22)+1,instr(free_res_val,',',1,22)-instr(free_res_val,',',1,21)-1) FREE_RES_VAL3, STD_UNIT, TOLL_STD_UNIT, STD_BASIC_CHARGE,STD_TOLL_CHARGE,STD_OTHER_CHARGE,ORI_BASIC_CHARGE, ORI_TOLL_CHARGE, ORI_OTHER_CHARGE, ADDUP_RES, OPP_CONDITION_ID, CONDITION_ID, NETCALL_FLAG, ESN, SEQUENCE_NO, MODIFICATION_IND, OPP_ROAM_AREACODE, OPP_HOME_AREACODE, TOLL_TYPE, TOLL_TYPE2, MSRN, MSC_ID, SCP_ID, LAC_ID, CELL_ID, SERVICE_TYPE, SERVICE_CODE, SERVICE_KEY, STOP_CAUSE, IN_TRUNKID, OUT_TRUNKID, GROUP_ID, MOC_ID, MTC_ID, to_char(PROCESS_TIME,'YYYYMMDDHH24MISS') PROCESS_TIME, BACKUP_DATE, ORIGINAL_FILE, USER_TYPE, VPLMN3, OPP_PLAN_ID, COLLECTION_ITEM, OPP_NOACCESS_NUMBER, REDO_FLAG, RESERVE1, RESERVE2, RESERVE3, RESERVE4, LATE_LINK, to_char(INPUT_TIME,'YYYYMMDDHH24MISS') INPUT_TIME, ROW_ID ,MONITOR_CDR,STD_ERR_CODE,MNS_TYPE from xzjf.dr_gsm_ii_$YYYYMMDD$
DATEPARAM=$YYYYMMDD$
AREAPARAM=891,892,893,894,895,896,897
